{"title":"drf 快速入门","slug":"django/0-Django drf 快速入门","date":"2021-01-18T10:34:55.608Z","updated":"2021-01-18T16:03:39.694Z","comments":true,"path":"api/articles/django/0-Django drf 快速入门.json","excerpt":null,"covers":["C:/Users/yango/Documents/Markdown/laonanhai/front/django/django_drf_test.png"],"content":"<h3 id=\"1-项目设置\"><a class=\"markdownIt-Anchor\" href=\"#1-项目设置\"></a> 1- 项目设置</h3>\n<p>创建一个名为 tutorial 的新django项目，然后启动一个名为 quickstart 的新app。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 创建项目目录</span><br><span class=\"line\">mkdir tutorial</span><br><span class=\"line\">cd tutorial</span><br><span class=\"line\"></span><br><span class=\"line\"># 创建一个virtualenv来隔离我们本地的包依赖关系</span><br><span class=\"line\">virtualenv env</span><br><span class=\"line\">source env&#x2F;bin&#x2F;activate  # 在Windows下使用 &#96;env\\Scripts\\activate&#96;</span><br><span class=\"line\"></span><br><span class=\"line\"># 在创建的虚拟环境中安装 Django 和 Django REST framework</span><br><span class=\"line\">pip install django</span><br><span class=\"line\">pip install djangorestframework</span><br><span class=\"line\"></span><br><span class=\"line\"># 创建一个新项目和一个单个应用</span><br><span class=\"line\">django-admin.py startproject tutorial .  # 注意结尾的&#39;.&#39;符号</span><br><span class=\"line\">cd tutorial</span><br><span class=\"line\">django-admin.py startapp quickstart</span><br><span class=\"line\">cd ..</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-1-数据库迁移\"><a class=\"markdownIt-Anchor\" href=\"#1-1-数据库迁移\"></a> 1-1 数据库迁移</h4>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python manage.py migrate</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-2-创建管理员用户\"><a class=\"markdownIt-Anchor\" href=\"#1-2-创建管理员用户\"></a> 1-2 创建管理员用户</h4>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python manage.py createsuperuser</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-serializers\"><a class=\"markdownIt-Anchor\" href=\"#2-serializers\"></a> 2- Serializers</h3>\n<p>编写序列化器,创建一个名为 tutorial/quickstart/serializers.py的文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from django.contrib.auth.models import User, Group</span><br><span class=\"line\">from rest_framework import serializers</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class UserSerializer(serializers.HyperlinkedModelSerializer):</span><br><span class=\"line\">    class Meta:</span><br><span class=\"line\">        model &#x3D; User</span><br><span class=\"line\">        fields &#x3D; (&#39;url&#39;, &#39;username&#39;, &#39;email&#39;, &#39;groups&#39;)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class GroupSerializer(serializers.HyperlinkedModelSerializer):</span><br><span class=\"line\">    class Meta:</span><br><span class=\"line\">        model &#x3D; Group</span><br><span class=\"line\">        fields &#x3D; (&#39;url&#39;, &#39;name&#39;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-views\"><a class=\"markdownIt-Anchor\" href=\"#3-views\"></a> 3- Views</h3>\n<p>编写视图,  tutorial/quickstart/views.py</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from django.contrib.auth.models import User, Group</span><br><span class=\"line\">from rest_framework import viewsets</span><br><span class=\"line\">from tutorial.quickstart.serializers import UserSerializer, GroupSerializer</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class UserViewSet(viewsets.ModelViewSet):</span><br><span class=\"line\">    &quot;&quot;&quot;</span><br><span class=\"line\">    允许用户查看或编辑的API路径。</span><br><span class=\"line\">    &quot;&quot;&quot;</span><br><span class=\"line\">    queryset &#x3D; User.objects.all().order_by(&#39;-date_joined&#39;)</span><br><span class=\"line\">    serializer_class &#x3D; UserSerializer</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class GroupViewSet(viewsets.ModelViewSet):</span><br><span class=\"line\">    &quot;&quot;&quot;</span><br><span class=\"line\">    允许组查看或编辑的API路径。</span><br><span class=\"line\">    &quot;&quot;&quot;</span><br><span class=\"line\">    queryset &#x3D; Group.objects.all()</span><br><span class=\"line\">    serializer_class &#x3D; GroupSerializer</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-urls\"><a class=\"markdownIt-Anchor\" href=\"#4-urls\"></a> 4- URLs</h3>\n<p>在tutorial/urls.py中开始写连接API的URLs</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from django.conf.urls import url, include</span><br><span class=\"line\">from rest_framework import routers</span><br><span class=\"line\">from tutorial.quickstart import views</span><br><span class=\"line\"></span><br><span class=\"line\">router &#x3D; routers.DefaultRouter()</span><br><span class=\"line\">router.register(r&#39;users&#39;, views.UserViewSet)</span><br><span class=\"line\">router.register(r&#39;groups&#39;, views.GroupViewSet)</span><br><span class=\"line\"></span><br><span class=\"line\"># 使用自动URL路由连接我们的API。</span><br><span class=\"line\"># 另外，我们还包括支持浏览器浏览API的登录URL。</span><br><span class=\"line\">urlpatterns &#x3D; [</span><br><span class=\"line\">    url(r&#39;^&#39;, include(router.urls)),</span><br><span class=\"line\">    url(r&#39;^api-auth&#x2F;&#39;, include(&#39;rest_framework.urls&#39;, namespace&#x3D;&#39;rest_framework&#39;))</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-settings\"><a class=\"markdownIt-Anchor\" href=\"#5-settings\"></a> 5- Settings</h3>\n<p>全局设置</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">INSTALLED_APPS &#x3D; (</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    &#39;rest_framework&#39;,</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">REST_FRAMEWORK &#x3D; &#123;</span><br><span class=\"line\">    &#39;DEFAULT_PERMISSION_CLASSES&#39;: [</span><br><span class=\"line\">        &#39;rest_framework.permissions.IsAdminUser&#39;,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &#39;PAGE_SIZE&#39;: 10</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"6-测试我们的api\"><a class=\"markdownIt-Anchor\" href=\"#6-测试我们的api\"></a> 6- 测试我们的API</h3>\n<p>直接通过浏览器，转到URL <a href=\"http://127.0.0.1:8000/users/\">http://127.0.0.1:8000/users/</a>…</p>\n<p><img src=\"C:/Users/yango/Documents/Markdown/laonanhai/front/django/django_drf_test.png\" alt=\"image\" /></p>\n","more":"<h3 id=\"1-项目设置\"><a class=\"markdownIt-Anchor\" href=\"#1-项目设置\"></a> 1- 项目设置</h3>\n<p>创建一个名为 tutorial 的新django项目，然后启动一个名为 quickstart 的新app。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 创建项目目录</span><br><span class=\"line\">mkdir tutorial</span><br><span class=\"line\">cd tutorial</span><br><span class=\"line\"></span><br><span class=\"line\"># 创建一个virtualenv来隔离我们本地的包依赖关系</span><br><span class=\"line\">virtualenv env</span><br><span class=\"line\">source env&#x2F;bin&#x2F;activate  # 在Windows下使用 &#96;env\\Scripts\\activate&#96;</span><br><span class=\"line\"></span><br><span class=\"line\"># 在创建的虚拟环境中安装 Django 和 Django REST framework</span><br><span class=\"line\">pip install django</span><br><span class=\"line\">pip install djangorestframework</span><br><span class=\"line\"></span><br><span class=\"line\"># 创建一个新项目和一个单个应用</span><br><span class=\"line\">django-admin.py startproject tutorial .  # 注意结尾的&#39;.&#39;符号</span><br><span class=\"line\">cd tutorial</span><br><span class=\"line\">django-admin.py startapp quickstart</span><br><span class=\"line\">cd ..</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-1-数据库迁移\"><a class=\"markdownIt-Anchor\" href=\"#1-1-数据库迁移\"></a> 1-1 数据库迁移</h4>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python manage.py migrate</span><br></pre></td></tr></table></figure>\n<h4 id=\"1-2-创建管理员用户\"><a class=\"markdownIt-Anchor\" href=\"#1-2-创建管理员用户\"></a> 1-2 创建管理员用户</h4>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python manage.py createsuperuser</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-serializers\"><a class=\"markdownIt-Anchor\" href=\"#2-serializers\"></a> 2- Serializers</h3>\n<p>编写序列化器,创建一个名为 tutorial/quickstart/serializers.py的文件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from django.contrib.auth.models import User, Group</span><br><span class=\"line\">from rest_framework import serializers</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class UserSerializer(serializers.HyperlinkedModelSerializer):</span><br><span class=\"line\">    class Meta:</span><br><span class=\"line\">        model &#x3D; User</span><br><span class=\"line\">        fields &#x3D; (&#39;url&#39;, &#39;username&#39;, &#39;email&#39;, &#39;groups&#39;)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class GroupSerializer(serializers.HyperlinkedModelSerializer):</span><br><span class=\"line\">    class Meta:</span><br><span class=\"line\">        model &#x3D; Group</span><br><span class=\"line\">        fields &#x3D; (&#39;url&#39;, &#39;name&#39;)</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-views\"><a class=\"markdownIt-Anchor\" href=\"#3-views\"></a> 3- Views</h3>\n<p>编写视图,  tutorial/quickstart/views.py</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from django.contrib.auth.models import User, Group</span><br><span class=\"line\">from rest_framework import viewsets</span><br><span class=\"line\">from tutorial.quickstart.serializers import UserSerializer, GroupSerializer</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class UserViewSet(viewsets.ModelViewSet):</span><br><span class=\"line\">    &quot;&quot;&quot;</span><br><span class=\"line\">    允许用户查看或编辑的API路径。</span><br><span class=\"line\">    &quot;&quot;&quot;</span><br><span class=\"line\">    queryset &#x3D; User.objects.all().order_by(&#39;-date_joined&#39;)</span><br><span class=\"line\">    serializer_class &#x3D; UserSerializer</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class GroupViewSet(viewsets.ModelViewSet):</span><br><span class=\"line\">    &quot;&quot;&quot;</span><br><span class=\"line\">    允许组查看或编辑的API路径。</span><br><span class=\"line\">    &quot;&quot;&quot;</span><br><span class=\"line\">    queryset &#x3D; Group.objects.all()</span><br><span class=\"line\">    serializer_class &#x3D; GroupSerializer</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-urls\"><a class=\"markdownIt-Anchor\" href=\"#4-urls\"></a> 4- URLs</h3>\n<p>在tutorial/urls.py中开始写连接API的URLs</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from django.conf.urls import url, include</span><br><span class=\"line\">from rest_framework import routers</span><br><span class=\"line\">from tutorial.quickstart import views</span><br><span class=\"line\"></span><br><span class=\"line\">router &#x3D; routers.DefaultRouter()</span><br><span class=\"line\">router.register(r&#39;users&#39;, views.UserViewSet)</span><br><span class=\"line\">router.register(r&#39;groups&#39;, views.GroupViewSet)</span><br><span class=\"line\"></span><br><span class=\"line\"># 使用自动URL路由连接我们的API。</span><br><span class=\"line\"># 另外，我们还包括支持浏览器浏览API的登录URL。</span><br><span class=\"line\">urlpatterns &#x3D; [</span><br><span class=\"line\">    url(r&#39;^&#39;, include(router.urls)),</span><br><span class=\"line\">    url(r&#39;^api-auth&#x2F;&#39;, include(&#39;rest_framework.urls&#39;, namespace&#x3D;&#39;rest_framework&#39;))</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-settings\"><a class=\"markdownIt-Anchor\" href=\"#5-settings\"></a> 5- Settings</h3>\n<p>全局设置</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">INSTALLED_APPS &#x3D; (</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    &#39;rest_framework&#39;,</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">REST_FRAMEWORK &#x3D; &#123;</span><br><span class=\"line\">    &#39;DEFAULT_PERMISSION_CLASSES&#39;: [</span><br><span class=\"line\">        &#39;rest_framework.permissions.IsAdminUser&#39;,</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &#39;PAGE_SIZE&#39;: 10</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"6-测试我们的api\"><a class=\"markdownIt-Anchor\" href=\"#6-测试我们的api\"></a> 6- 测试我们的API</h3>\n<p>直接通过浏览器，转到URL <a href=\"http://127.0.0.1:8000/users/\">http://127.0.0.1:8000/users/</a>…</p>\n<p><img src=\"C:/Users/yango/Documents/Markdown/laonanhai/front/django/django_drf_test.png\" alt=\"image\" /></p>\n","categories":[{"name":"restful","path":"api/categories/restful.json"},{"name":"django","path":"api/categories/django.json"}],"tags":[{"name":"python","path":"api/tags/python.json"},{"name":"drf","path":"api/tags/drf.json"},{"name":"django","path":"api/tags/django.json"}]}